<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö –ï–ì–≠ –†—É—Å—Å–∫–∏–π | –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --accent-primary: #3390ec;
            --accent-secondary: #2481cc;
            --text-primary: #17212b;
            --text-secondary: #6b7b8c;
            --text-muted: #8a9aa8;
            --border-color: #e6ecf0;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --error-color: #e74c3c;
            --exam-color: #9b59b6;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --tg-bg-color: var(--bg-primary);
            --tg-text-color: var(--text-primary);
            --tg-hint-color: var(--text-muted);
            --tg-link-color: var(--accent-primary);
            --tg-button-color: var(--accent-primary);
            --tg-button-text-color: #ffffff;
            --tg-secondary-bg-color: var(--bg-secondary);
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ Telegram */
        .theme-dark {
            --bg-primary: #17212b;
            --bg-secondary: #1f2c3a;
            --bg-tertiary: #243342;
            --accent-primary: #3390ec;
            --accent-secondary: #2481cc;
            --text-primary: #e1e9f0;
            --text-secondary: #a8b5c1;
            --text-muted: #6b7b8c;
            --border-color: #2a3b4d;
            --exam-color: #8e44ad;
        }

        /* –ù–µ–∂–Ω–∞—è —Ç–µ–º–∞ */
        .theme-soft {
            --bg-primary: #fff5f7;
            --bg-secondary: #fce7f3;
            --bg-tertiary: #fbcfe8;
            --accent-primary: #ec4899;
            --accent-secondary: #db2777;
            --text-primary: #831843;
            --text-secondary: #be185d;
            --text-muted: #9d174d;
            --border-color: #f9a8d4;
            --exam-color: #d946ef;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'SF Pro Display', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 12px;
            transition: all 0.3s ease;
        }

        .app-container {
            max-width: 100%;
            margin: 0 auto;
        }

        /* Header */
        .header {
            padding: 16px 0;
            margin-bottom: 16px;
            animation: slideDown 0.4s ease;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: var(--accent-primary);
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }

        .logo-text h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.3px;
        }

        .logo-text p {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .icon-btn:hover {
            background: var(--bg-tertiary);
            transform: translateY(-1px);
        }

        /* Daily Stats */
        .daily-stats {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 16px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .stats-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }

        .stat {
            flex: 1;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-primary);
            line-height: 1;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-weight: 600;
        }

        .streak-counter {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .streak-icon {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            background: var(--warning-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .streak-info {
            flex: 1;
        }

        .streak-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .streak-days {
            font-size: 20px;
            font-weight: 700;
            color: var(--warning-color);
        }

        .streak-next {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Navigation - –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è 5 –≤–∫–ª–∞–¥–æ–∫ */
        .nav {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-bottom: 20px;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 8px;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.5s ease 0.1s both;
        }

        .nav-btn {
            padding: 10px 0;
            text-align: center;
            border-radius: var(--radius-md);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            position: relative;
        }

        .nav-btn i {
            font-size: 14px;
        }

        .nav-btn.active {
            background: var(--bg-primary);
            color: var(--text-primary);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .nav-btn:hover:not(.active) {
            background: var(--bg-tertiary);
        }

        .nav-badge {
            position: absolute;
            top: -2px;
            right: 4px;
            background: var(--error-color);
            color: white;
            font-size: 9px;
            width: 14px;
            height: 14px;
            border-radius: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Content Tabs */
        .tab-content {
            display: none;
            animation: fadeInUp 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Task Card */
        .task-card {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-primary);
        }

        .task-card.exam::before {
            background: var(--exam-color);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .task-number {
            background: var(--bg-tertiary);
            color: var(--accent-primary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        .task-card.exam .task-number {
            background: var(--exam-color);
            color: white;
            opacity: 0.9;
        }

        .task-theme {
            color: var(--text-muted);
            font-size: 13px;
            margin-top: 4px;
        }

        .task-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--accent-primary);
            color: white;
            transform: translateY(-1px);
        }

        .task-text {
            line-height: 1.6;
            font-size: 15px;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .task-text .highlight {
            background: var(--bg-tertiary);
            padding: 2px 4px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            color: var(--accent-primary);
        }

        .options-container {
            margin: 16px 0;
        }

        .option {
            padding: 14px;
            margin-bottom: 8px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option:hover {
            border-color: var(--accent-primary);
            transform: translateX(2px);
        }

        .option.selected {
            border-color: var(--accent-primary);
            background: var(--bg-tertiary);
        }

        .option-marker {
            width: 22px;
            height: 22px;
            border-radius: 11px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--text-muted);
            flex-shrink: 0;
            font-size: 12px;
        }

        .option.selected .option-marker {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .option-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }

        .answer-input {
            width: 100%;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 14px;
            font-size: 15px;
            color: var(--text-primary);
            margin-bottom: 16px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(51, 144, 236, 0.1);
        }

        /* Buttons */
        .btn {
            padding: 14px 20px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            flex: 1;
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            transform: translateY(-1px);
        }

        .btn-exam {
            background: var(--exam-color);
            color: white;
            flex: 1;
        }

        .btn-exam:hover {
            background: #8e44ad;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: var(--error-color);
            color: white;
            flex: 1;
        }

        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-1px);
        }

        .buttons-row {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }

        /* Result */
        .result {
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            animation: fadeIn 0.5s ease;
            text-align: center;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
        }

        .result.correct {
            border-color: var(--success-color);
            background: var(--bg-secondary);
        }

        .result.incorrect {
            border-color: var(--error-color);
            background: var(--bg-secondary);
        }

        .result-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .result.correct .result-icon {
            color: var(--success-color);
        }

        .result.incorrect .result-icon {
            color: var(--error-color);
        }

        .result-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .result-desc {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }

        .result-answer {
            background: var(--bg-tertiary);
            padding: 10px;
            border-radius: var(--radius-sm);
            margin-top: 12px;
            font-weight: 600;
            font-size: 14px;
        }

        /* Achievements */
        .achievements-container {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .achievements-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .achievements-title i {
            color: var(--warning-color);
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .achievement {
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .achievement.locked {
            opacity: 0.7;
        }

        .achievement.unlocked {
            border-color: var(--warning-color);
        }

        .achievement-badge {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 20px;
            color: white;
        }

        .achievement.locked .achievement-badge {
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        .achievement-title {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .achievement-desc {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .achievement-progress {
            height: 3px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .achievement-progress-fill {
            height: 100%;
            background: var(--accent-primary);
            border-radius: 2px;
            transition: width 0.6s ease;
        }

        /* Theory Tab */
        .theory-section {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .theory-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .theory-icon {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .theory-title {
            font-size: 18px;
            font-weight: 700;
            flex: 1;
        }

        .theory-content {
            line-height: 1.6;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .theory-content h3 {
            color: var(--text-primary);
            margin: 16px 0 8px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .theory-content p {
            margin-bottom: 12px;
        }

        .theory-content ul {
            margin-left: 20px;
            margin-bottom: 16px;
        }

        .theory-content li {
            margin-bottom: 6px;
        }

        /* Exam Variants Tab */
        .exam-variants-container {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
        }

        .exam-variants-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .exam-variants-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exam-variants-title i {
            color: var(--exam-color);
        }

        .exam-variants-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .exam-variant {
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .exam-variant:hover {
            border-color: var(--exam-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .exam-variant-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--exam-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 20px;
            color: white;
        }

        .exam-variant-title {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .exam-variant-desc {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .exam-variant-stats {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 8px;
            display: flex;
            justify-content: space-between;
        }

        .exam-variant-progress {
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .exam-variant-progress-fill {
            height: 100%;
            background: var(--exam-color);
            border-radius: 2px;
            transition: width 0.6s ease;
        }

        /* Admin Panel */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
            display: none;
            animation: slideDown 0.4s ease;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .admin-title {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-title i {
            color: var(--accent-primary);
        }

        .close-admin {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-admin:hover {
            background: var(--error-color);
            color: white;
        }

        .admin-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 16px;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 10px 16px;
            border-radius: var(--radius-md);
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            white-space: nowrap;
        }

        .admin-tab.active {
            background: var(--accent-primary);
            color: white;
        }

        .admin-tab:hover:not(.active) {
            background: var(--bg-tertiary);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 12px;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236b7b8c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(51, 144, 236, 0.1);
        }

        .admin-buttons {
            display: flex;
            gap: 10px;
            margin-top: 24px;
        }

        .admin-buttons .btn {
            flex: 1;
        }

        /* Admin Task List */
        .admin-task-item {
            background: var(--bg-secondary);
            padding: 12px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            transition: all 0.3s ease;
        }

        .admin-task-item:hover {
            background: var(--bg-tertiary);
        }

        .admin-task-info {
            flex: 1;
        }

        .admin-task-number {
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 4px;
        }

        .admin-task-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .admin-task-actions {
            display: flex;
            gap: 6px;
        }

        .admin-task-action-btn {
            width: 28px;
            height: 28px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-task-action-btn:hover {
            transform: scale(1.1);
        }

        .admin-task-action-btn.edit:hover {
            background: var(--accent-primary);
            color: white;
        }

        .admin-task-action-btn.delete:hover {
            background: var(--error-color);
            color: white;
        }

        /* Auth Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
            display: none;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-container {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: 24px;
            max-width: 320px;
            width: 90%;
            border: 1px solid var(--border-color);
            animation: fadeInUp 0.4s ease;
        }

        .auth-icon {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 24px;
        }

        .auth-title {
            text-align: center;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .auth-subtitle {
            text-align: center;
            color: var(--text-muted);
            margin-bottom: 20px;
            font-size: 14px;
        }

        .auth-input {
            width: 100%;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 14px;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: 16px;
            text-align: center;
            letter-spacing: 1px;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .auth-error {
            color: var(--error-color);
            text-align: center;
            margin-bottom: 16px;
            font-size: 14px;
            min-height: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ */
        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 8px 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            z-index: 1000;
            box-shadow: var(--shadow-md);
            display: none;
        }

        .sync-status.syncing {
            border-color: var(--warning-color);
            color: var(--warning-color);
        }

        .sync-status.success {
            border-color: var(--success-color);
            color: var(--success-color);
        }

        .sync-status.error {
            border-color: var(--error-color);
            color: var(--error-color);
        }

        /* Animations */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .bounce {
            animation: bounce 1s infinite;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        /* Progress Bar */
        .progress-bar {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-primary);
            border-radius: 3px;
            transition: width 0.6s ease;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .stat-card {
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .stat-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 18px;
            color: white;
        }

        .stat-card-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 4px;
        }

        .stat-card-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .stats-row {
                flex-direction: column;
                gap: 16px;
            }
            
            .nav {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .achievements-grid, .stats-grid, .exam-variants-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                padding: 12px 16px;
                font-size: 14px;
            }
            
            .task-card, .achievements-container, .theory-section, .exam-variants-container {
                padding: 16px;
            }
            
            .admin-tabs {
                overflow-x: auto;
                padding-bottom: 12px;
            }
            
            .admin-tab {
                font-size: 12px;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body class="theme-light">
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div class="logo-text">
                        <h1>–ï–ì–≠ –†—É—Å—Å–∫–∏–π</h1>
                        <p>–ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –≤ Telegram</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" id="stats-btn" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">
                        <i class="fas fa-chart-bar"></i>
                    </button>
                    <button class="icon-btn" id="achievements-btn" title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è">
                        <i class="fas fa-trophy"></i>
                    </button>
                    <button class="icon-btn" id="sync-btn" title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å">
                        <i class="fas fa-sync"></i>
                    </button>
                    <button class="icon-btn" id="admin-btn" title="–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
            
            <div class="daily-stats">
                <div class="stats-row">
                    <div class="stat">
                        <div class="stat-value" id="total-tasks">0</div>
                        <div class="stat-label">–ó–∞–¥–∞–Ω–∏–π</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="solved-count">0</div>
                        <div class="stat-label">–†–µ—à–µ–Ω–æ</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="correct-rate">0%</div>
                        <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                    </div>
                </div>
                
                <div class="streak-counter">
                    <div class="streak-icon">
                        <i class="fas fa-fire"></i>
                    </div>
                    <div class="streak-info">
                        <div class="streak-title">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                        <div class="streak-days" id="streak-days">0</div>
                        <div class="streak-next" id="streak-next">–°–ª–µ–¥—É—é—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ –æ–±–Ω–æ–≤–∏—Ç —Å—á—ë—Ç—á–∏–∫</div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Navigation - –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è 5 –≤–∫–ª–∞–¥–æ–∫ -->
        <nav class="nav">
            <button class="nav-btn active" data-tab="practice">
                <i class="fas fa-dice"></i>
                <span>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</span>
            </button>
            <button class="nav-btn" data-tab="tasks">
                <i class="fas fa-list"></i>
                <span>–í—Å–µ –∑–∞–¥–∞–Ω–∏—è</span>
                <div class="nav-badge" id="new-tasks-badge" style="display: none;">0</div>
            </button>
            <button class="nav-btn" data-tab="exams">
                <i class="fas fa-file-alt"></i>
                <span>–ü—Ä–æ–±–Ω–∏–∫–∏</span>
                <div class="nav-badge" id="new-exams-badge" style="display: none;">0</div>
            </button>
            <button class="nav-btn" data-tab="theory">
                <i class="fas fa-graduation-cap"></i>
                <span>–¢–µ–æ—Ä–∏—è</span>
            </button>
            <button class="nav-btn" data-tab="achievements">
                <i class="fas fa-trophy"></i>
                <span>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
            </button>
        </nav>
        
        <!-- Practice Tab -->
        <div class="tab-content active" id="practice-tab">
            <div class="task-card">
                <div class="task-header">
                    <div>
                        <div class="task-number" id="task-number">–ó–∞–¥–∞–Ω–∏–µ #1</div>
                        <div class="task-theme" id="task-theme">–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è</div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn" id="hint-btn" title="–ü–æ–¥—Å–∫–∞–∑–∫–∞">
                            <i class="fas fa-lightbulb"></i>
                        </button>
                        <button class="action-btn" id="favorite-btn" title="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">
                            <i class="far fa-star"></i>
                        </button>
                    </div>
                </div>
                
                <div class="task-text" id="task-text">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏—è...
                </div>
                
                <div id="options-container"></div>
                
                <div id="result-container"></div>
                
                <input type="text" class="answer-input" id="answer-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç..." autocomplete="off" style="display: none;">
                
                <div class="buttons-row">
                    <button class="btn btn-primary" id="check-btn">
                        <i class="fas fa-check"></i>
                        <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
                    </button>
                    <button class="btn btn-secondary" id="next-btn">
                        <i class="fas fa-redo"></i>
                        <span>–°–ª–µ–¥—É—é—â–µ–µ</span>
                    </button>
                </div>
            </div>
            
            <div class="task-card">
                <div class="task-header">
                    <div>
                        <div class="task-number">–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–µ–≥–æ–¥–Ω—è</div>
                        <div class="task-theme">–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ü–µ–ª—å: 5 –∑–∞–¥–∞–Ω–∏–π</div>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="daily-progress" style="width: 0%"></div>
                </div>
                <div style="text-align: center; color: var(--text-muted); font-size: 13px; margin-top: 8px;">
                    –†–µ—à–µ–Ω–æ: <span id="daily-solved">0</span>/5 –∑–∞–¥–∞–Ω–∏–π
                </div>
            </div>
        </div>
        
        <!-- Tasks Tab -->
        <div class="tab-content" id="tasks-tab">
            <div class="task-card">
                <div class="task-header">
                    <div>
                        <div class="task-number">–í—Å–µ –∑–∞–¥–∞–Ω–∏—è</div>
                        <div class="task-theme" id="tasks-count">0 –∑–∞–¥–∞–Ω–∏–π</div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-card-value" id="completed-tasks">0</div>
                        <div class="stat-card-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-card-value" id="favorite-tasks">0</div>
                        <div class="stat-card-label">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</div>
                    </div>
                </div>
            </div>
            
            <div id="tasks-list-container">
                <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
        
        <!-- Exams Tab -->
        <div class="tab-content" id="exams-tab">
            <div class="exam-variants-container">
                <div class="exam-variants-header">
                    <div class="exam-variants-title">
                        <i class="fas fa-file-alt"></i>
                        <span>–ü—Ä–æ–±–Ω–∏–∫–∏ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã</span>
                    </div>
                    <div id="exams-count">0 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
                </div>
                
                <div class="exam-variants-grid" id="exams-grid">
                    <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="buttons-row">
                    <button class="btn btn-exam" id="start-exam-btn">
                        <i class="fas fa-play-circle"></i>
                        <span>–ù–∞—á–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</span>
                    </button>
                </div>
            </div>
            
            <div id="exam-content-container">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <!-- Theory Tab -->
        <div class="tab-content" id="theory-tab">
            <div id="theory-content-container">
                <!-- –¢–µ–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
        
        <!-- Achievements Tab -->
        <div class="tab-content" id="achievements-tab">
            <div class="achievements-container">
                <div class="achievements-header">
                    <div class="achievements-title">
                        <i class="fas fa-trophy"></i>
                        <span>–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
                    </div>
                    <div id="achievements-count">0/12</div>
                </div>
                
                <div class="achievements-grid" id="achievements-grid">
                    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
        
        <!-- Admin Panel -->
        <div class="admin-panel" id="admin-panel">
            <div class="admin-header">
                <div class="admin-title">
                    <i class="fas fa-cog"></i>
                    <span>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</span>
                </div>
                <button class="close-admin" id="close-admin">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="admin-tabs">
                <button class="admin-tab active" data-admin-tab="tasks">–ó–∞–¥–∞–Ω–∏—è</button>
                <button class="admin-tab" data-admin-tab="exams">–ü—Ä–æ–±–Ω–∏–∫–∏</button>
                <button class="admin-tab" data-admin-tab="theory">–¢–µ–æ—Ä–∏—è</button>
                <button class="admin-tab" data-admin-tab="users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="admin-tab" data-admin-tab="sync">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</button>
            </div>
            
            <!-- Tasks Admin -->
            <div class="admin-content active" id="admin-tasks-tab">
                <div class="form-group">
                    <label class="form-label">–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-edit-mode">
                        <option value="new">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</option>
                        <option value="edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ</option>
                    </select>
                </div>
                
                <div class="form-group" id="edit-task-select-group" style="display: none;">
                    <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-edit-task-select">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä –∑–∞–¥–∞–Ω–∏—è (1-27)</label>
                    <input type="number" class="form-input" id="admin-task-number" min="1" max="27" value="1">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–µ–º–∞ –∑–∞–¥–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-task-theme">
                        <option value="–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è">–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è</option>
                        <option value="–ü—É–Ω–∫—Ç—É–∞—Ü–∏—è">–ü—É–Ω–∫—Ç—É–∞—Ü–∏—è</option>
                        <option value="–õ–µ–∫—Å–∏–∫–∞">–õ–µ–∫—Å–∏–∫–∞</option>
                        <option value="–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞">–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞</option>
                        <option value="–°–∏–Ω—Ç–∞–∫—Å–∏—Å">–°–∏–Ω—Ç–∞–∫—Å–∏—Å</option>
                        <option value="–†–µ—á–µ–≤—ã–µ –Ω–æ—Ä–º—ã">–†–µ—á–µ–≤—ã–µ –Ω–æ—Ä–º—ã</option>
                        <option value="–ü–∞—Ä–æ–Ω–∏–º—ã">–ü–∞—Ä–æ–Ω–∏–º—ã</option>
                        <option value="–¢–µ–∫—Å—Ç">–¢–µ–∫—Å—Ç</option>
                        <option value="–°–æ—á–∏–Ω–µ–Ω–∏–µ">–°–æ—á–∏–Ω–µ–Ω–∏–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è</label>
                    <textarea class="form-textarea" id="admin-task-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –∑–∞–¥–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-task-type">
                        <option value="single">–û–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞</option>
                        <option value="multiple">–ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</option>
                        <option value="number">–ß–∏—Å–ª–æ–≤–æ–π –æ—Ç–≤–µ—Ç</option>
                        <option value="text">–¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç</option>
                    </select>
                </div>
                
                <div class="form-group" id="admin-options-group">
                    <label class="form-label">–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (—á–µ—Ä–µ–∑ ;)</label>
                    <input type="text" class="form-input" id="admin-task-options" placeholder="–í–∞—Ä–∏–∞–Ω—Ç 1; –í–∞—Ä–∏–∞–Ω—Ç 2; –í–∞—Ä–∏–∞–Ω—Ç 3">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</label>
                    <input type="text" class="form-input" id="admin-task-answer" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç...">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ü–æ–¥—Å–∫–∞–∑–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea class="form-textarea" id="admin-task-hint" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–¥—Å–∫–∞–∑–∫—É..."></textarea>
                </div>
                
                <div class="admin-buttons">
                    <button class="btn btn-primary" id="save-task-btn">
                        <i class="fas fa-save"></i>
                        <span id="save-task-btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</span>
                    </button>
                    <button class="btn btn-danger" id="delete-task-btn" style="display: none;">
                        <i class="fas fa-trash"></i>
                        <span>–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</span>
                    </button>
                </div>
                
                <div class="form-group" style="margin-top: 30px;">
                    <label class="form-label">–í—Å–µ –∑–∞–¥–∞–Ω–∏—è (–≤—Å–µ–≥–æ: <span id="admin-tasks-count">0</span>)</label>
                    <div id="admin-tasks-list" style="max-height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 12px; background: var(--bg-tertiary);">
                        <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <!-- Exams Admin -->
            <div class="admin-content" id="admin-exams-tab">
                <div class="form-group">
                    <label class="form-label">–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-exam-edit-mode">
                        <option value="new">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</option>
                        <option value="edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π</option>
                    </select>
                </div>
                
                <div class="form-group" id="edit-exam-select-group" style="display: none;">
                    <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                    <select class="form-select" id="admin-edit-exam-select">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞</label>
                    <input type="text" class="form-input" id="admin-exam-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç #1">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞</label>
                    <textarea class="form-textarea" id="admin-exam-description" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç, –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å..." style="min-height: 80px;"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ</label>
                    <input type="number" class="form-input" id="admin-exam-tasks-count" min="1" max="27" value="10">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ID –∑–∞–¥–∞–Ω–∏–π –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <input type="text" class="form-input" id="admin-exam-task-ids" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1,2,3,4,5,6,7,8,9,10">
                    <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                        –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –∑–∞–¥–∞–Ω–∏–π
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–º–∏–Ω—É—Ç)</label>
                    <input type="number" class="form-input" id="admin-exam-time" min="5" max="240" value="60">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
                    <select class="form-select" id="admin-exam-difficulty">
                        <option value="–ª–µ–≥–∫–∏–π">–õ–µ–≥–∫–∏–π</option>
                        <option value="—Å—Ä–µ–¥–Ω–∏–π" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="—Å–ª–æ–∂–Ω—ã–π">–°–ª–æ–∂–Ω—ã–π</option>
                        <option value="—ç–∫—Å–ø–µ—Ä—Ç">–≠–∫—Å–ø–µ—Ä—Ç</option>
                    </select>
                </div>
                
                <div class="admin-buttons">
                    <button class="btn btn-exam" id="save-exam-btn">
                        <i class="fas fa-save"></i>
                        <span id="save-exam-btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</span>
                    </button>
                    <button class="btn btn-danger" id="delete-exam-btn" style="display: none;">
                        <i class="fas fa-trash"></i>
                        <span>–£–¥–∞–ª–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</span>
                    </button>
                </div>
                
                <div class="form-group" style="margin-top: 30px;">
                    <label class="form-label">–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–≤—Å–µ–≥–æ: <span id="admin-exams-count">0</span>)</label>
                    <div id="admin-exams-list" style="max-height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 12px; background: var(--bg-tertiary);">
                        <!-- –°–ø–∏—Å–æ–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <!-- Theory Admin -->
            <div class="admin-content" id="admin-theory-tab">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ —Ç–µ–æ—Ä–∏–∏</label>
                    <input type="text" class="form-input" id="admin-theory-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è - –ø—Ä–∞–≤–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏—Å—Ç–∞–≤–æ–∫">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞</label>
                    <textarea class="form-textarea" id="admin-theory-content" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ç–µ–æ—Ä–∏–∏..." style="min-height: 200px;"></textarea>
                    <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è HTML: &lt;h3&gt;–ó–∞–≥–æ–ª–æ–≤–æ–∫&lt;/h3&gt;, &lt;p&gt;–¢–µ–∫—Å—Ç&lt;/p&gt;, &lt;ul&gt;&lt;li&gt;–ü—É–Ω–∫—Ç&lt;/li&gt;&lt;/ul&gt;
                    </div>
                </div>
                
                <div class="admin-buttons">
                    <button class="btn btn-primary" id="save-theory-btn">
                        <i class="fas fa-save"></i>
                        <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–æ—Ä–∏—é</span>
                    </button>
                    <button class="btn btn-secondary" id="clear-theory-btn">
                        <i class="fas fa-broom"></i>
                        <span>–û—á–∏—Å—Ç–∏—Ç—å</span>
                    </button>
                </div>
                
                <div class="form-group" style="margin-top: 30px;">
                    <label class="form-label">–í—Å–µ —Ä–∞–∑–¥–µ–ª—ã —Ç–µ–æ—Ä–∏–∏</label>
                    <div id="admin-theory-list" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 12px; background: var(--bg-tertiary);">
                        <!-- –°–ø–∏—Å–æ–∫ —Ç–µ–æ—Ä–∏–∏ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <!-- Users Admin -->
            <div class="admin-content" id="admin-users-tab">
                <div class="form-group">
                    <label class="form-label">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            <div>
                                <div style="font-size: 24px; font-weight: 700; color: var(--accent-primary);" id="total-users">0</div>
                                <div style="font-size: 12px; color: var(--text-muted);">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                            </div>
                            <div>
                                <div style="font-size: 24px; font-weight: 700; color: var(--success-color);" id="active-today">0</div>
                                <div style="font-size: 12px; color: var(--text-muted);">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                            </div>
                        </div>
                        <div style="font-size: 13px; color: var(--text-secondary);">
                            –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID.
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                            –í—ã –º–æ–∂–µ—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
                        </div>
                        <button class="btn btn-danger" id="reset-user-btn" style="width: 100%;">
                            <i class="fas fa-trash"></i>
                            <span>–°–±—Ä–æ—Å–∏—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ</span>
                        </button>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px;">
                            –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å—é –≤–∞—à—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div style="margin-bottom: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" id="auto-reset-new-users" checked>
                                <span>–°–±—Ä–∞—Å—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
                            </label>
                        </div>
                        <div style="font-size: 12px; color: var(--text-muted);">
                            –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –Ω—É–ª—è
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Sync Admin -->
            <div class="admin-content" id="admin-sync-tab">
                <div class="form-group">
                    <label class="form-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div style="margin-bottom: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" id="auto-sync-enabled" checked>
                                <span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</span>
                            </label>
                        </div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">
                            –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 16px;">
                            <button class="btn btn-primary" id="force-sync-btn" style="flex: 1;">
                                <i class="fas fa-sync"></i>
                                <span>–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</span>
                            </button>
                            <button class="btn btn-secondary" id="clear-cache-btn" style="flex: 1;">
                                <i class="fas fa-broom"></i>
                                <span>–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div style="margin-bottom: 8px;">
                            <div style="font-size: 12px; color: var(--text-muted);">–ó–∞–¥–∞–Ω–∏—è</div>
                            <div style="font-size: 16px; font-weight: 700; color: var(--accent-primary);" id="sync-tasks-status">–ó–∞–≥—Ä—É–∂–µ–Ω–æ: 0</div>
                        </div>
                        
                        <div style="margin-bottom: 8px;">
                            <div style="font-size: 12px; color: var(--text-muted);">–ü—Ä–æ–±–Ω–∏–∫–∏</div>
                            <div style="font-size: 16px; font-weight: 700; color: var(--exam-color);" id="sync-exams-status">–ó–∞–≥—Ä—É–∂–µ–Ω–æ: 0</div>
                        </div>
                        
                        <div style="margin-bottom: 8px;">
                            <div style="font-size: 12px; color: var(--text-muted);">–¢–µ–æ—Ä–∏—è</div>
                            <div style="font-size: 16px; font-weight: 700; color: var(--success-color);" id="sync-theory-status">–ó–∞–≥—Ä—É–∂–µ–Ω–æ: 0</div>
                        </div>
                        
                        <div>
                            <div style="font-size: 12px; color: var(--text-muted);">–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-secondary);" id="last-sync-time">–ù–∏–∫–æ–≥–¥–∞</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ Telegram</label>
                    <div style="background: var(--bg-tertiary); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 12px;">–¢–æ–∫–µ–Ω –±–æ—Ç–∞</label>
                            <input type="text" class="form-input" id="bot-token-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞..." style="font-size: 13px; padding: 10px;">
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 12px;">ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</label>
                            <input type="text" class="form-input" id="admin-chat-id-input" placeholder="–í–≤–µ–¥–∏—Ç–µ ID..." style="font-size: 13px; padding: 10px;">
                        </div>
                        
                        <button class="btn btn-primary" id="save-bot-settings-btn" style="width: 100%;">
                            <i class="fas fa-save"></i>
                            <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</span>
                        </button>
                        
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px;">
                            –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è —É @BotFather, ID - —É @userinfobot
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Auth Modal -->
        <div class="auth-modal" id="auth-modal">
            <div class="auth-container">
                <div class="auth-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h2 class="auth-title">–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h2>
                <p class="auth-subtitle">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>
                
                <div class="auth-error" id="auth-error"></div>
                
                <input type="password" class="auth-input" id="admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="20">
                
                <div class="buttons-row">
                    <button class="btn btn-primary" id="submit-password">
                        <i class="fas fa-unlock"></i>
                        <span>–í–æ–π—Ç–∏</span>
                    </button>
                    <button class="btn btn-secondary" id="cancel-auth">
                        <span>–û—Ç–º–µ–Ω–∞</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ -->
        <div class="sync-status" id="sync-status">
            <i class="fas fa-sync"></i>
            <span id="sync-text"></span>
        </div>
    </div>

    <script>
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ë–û–¢–ê (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ò –î–ê–ù–ù–´–ï!)
        const DEFAULT_BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"; // –¢–æ–∫–µ–Ω –æ—Ç @BotFather
        const DEFAULT_ADMIN_CHAT_ID = "YOUR_CHAT_ID_HERE"; // –í–∞—à ID –∏–∑ @userinfobot
        const ADMIN_PASSWORD = "admin123";
        const STORAGE_PREFIX = "ege_russian_";
        
        // Telegram WebApp API
        let tg = window.Telegram.WebApp;
        
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let tasks = [];
        let exams = [];
        let theory = [];
        let currentTask = null;
        let currentExam = null;
        let currentExamTasks = [];
        let currentExamIndex = 0;
        let examTimer = null;
        let examTimeLeft = 0;
        let stats = {
            totalAttempts: 0,
            correctAttempts: 0,
            solvedTasks: [],
            favoriteTasks: [],
            solvedExams: [],
            examScores: {},
            lastActive: new Date().toISOString(),
            streak: 0,
            lastStreakDate: new Date().toISOString(),
            dailyProgress: 0,
            dailyDate: new Date().toISOString().split('T')[0]
        };
        let achievements = {};
        let selectedOptions = {};
        let isAdminAuthenticated = false;
        let userId = null;
        let editingTaskId = null;
        let editingExamId = null;
        let lastSyncTime = 0;
        const SYNC_INTERVAL = 30000;
        let botToken = DEFAULT_BOT_TOKEN;
        let adminChatId = DEFAULT_ADMIN_CHAT_ID;
        let BOT_API_URL = '';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        async function initApp() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
            loadBotSettings();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            initTelegram();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await loadUserData();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞
            await loadTasksFromBot();
            await loadExamsFromBot();
            await loadTheoryFromBot();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            loadAchievements();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateStatsDisplay();
            setupEventListeners();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            showRandomTask();
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–∫–∏
            renderTasksList();
            renderExamsList();
            renderTheory();
            renderAchievements();
            
            // –û–±–Ω–æ–≤–∏—Ç—å –±–µ–π–¥–∂–∏
            updateNewTasksBadge();
            updateNewExamsBadge();
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            updateDailyProgress();
            updateStreak();
            
            // –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
            startAutoSync();
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
            syncUserDataWithBot();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞
        function loadBotSettings() {
            const savedToken = localStorage.getItem(STORAGE_PREFIX + 'bot_token');
            const savedChatId = localStorage.getItem(STORAGE_PREFIX + 'admin_chat_id');
            
            if (savedToken && savedToken !== 'YOUR_BOT_TOKEN_HERE') {
                botToken = savedToken;
            }
            
            if (savedChatId && savedChatId !== 'YOUR_CHAT_ID_HERE') {
                adminChatId = savedChatId;
            }
            
            BOT_API_URL = `https://api.telegram.org/bot${botToken}`;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞
        function saveBotSettings() {
            const token = document.getElementById('bot-token-input').value.trim();
            const chatId = document.getElementById('admin-chat-id-input').value.trim();
            
            if (token && token !== 'YOUR_BOT_TOKEN_HERE') {
                botToken = token;
                localStorage.setItem(STORAGE_PREFIX + 'bot_token', token);
            }
            
            if (chatId && chatId !== 'YOUR_CHAT_ID_HERE') {
                adminChatId = chatId;
                localStorage.setItem(STORAGE_PREFIX + 'admin_chat_id', chatId);
            }
            
            BOT_API_URL = `https://api.telegram.org/bot${botToken}`;
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }
        
        // ==================== TELEGRAM BOT FUNCTIONS ====================
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–µ
        async function saveDataToBot(key, data) {
            if (!botToken || botToken === 'YOUR_BOT_TOKEN_HERE' || !adminChatId || adminChatId === 'YOUR_CHAT_ID_HERE') {
                console.warn('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ –Ω–µ –∑–∞–¥–∞–Ω—ã');
                return false;
            }
            
            try {
                const message = `DATA_${key}:${JSON.stringify(data)}`;
                
                const response = await fetch(BOT_API_URL + '/sendMessage', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: adminChatId,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                return result.ok;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–µ:', error);
                return false;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞
        async function loadDataFromBot(key) {
            if (!botToken || botToken === 'YOUR_BOT_TOKEN_HERE') {
                console.warn('–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ –∑–∞–¥–∞–Ω');
                return null;
            }
            
            try {
                const response = await fetch(BOT_API_URL + '/getUpdates?offset=-100');
                const data = await response.json();
                
                if (!data.ok) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞');
                    return null;
                }
                
                const messages = data.result || [];
                for (let i = messages.length - 1; i >= 0; i--) {
                    const message = messages[i].message;
                    if (message && message.text && message.text.startsWith(`DATA_${key}:`)) {
                        const jsonString = message.text.substring(`DATA_${key}:`.length);
                        return JSON.parse(jsonString);
                    }
                }
                
                return null;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞:', error);
                return null;
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞
        async function deleteDataFromBot(key, id) {
            try {
                const data = await loadDataFromBot(key);
                if (data && Array.isArray(data)) {
                    const updatedData = data.filter(item => item.id !== id);
                    return await saveDataToBot(key, updatedData);
                }
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞:', error);
                return false;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π –∏–∑ –±–æ—Ç–∞
        async function loadTasksFromBot() {
            try {
                const botTasks = await loadDataFromBot('tasks');
                if (botTasks && Array.isArray(botTasks) && botTasks.length > 0) {
                    tasks = botTasks;
                    saveTasksToLocalStorage();
                    updateSyncStatus('tasks', tasks.length);
                    return true;
                } else {
                    const savedTasks = localStorage.getItem(STORAGE_PREFIX + 'tasks');
                    if (savedTasks) {
                        tasks = JSON.parse(savedTasks);
                    } else {
                        tasks = getInitialTasks();
                        saveTasksToLocalStorage();
                        await saveDataToBot('tasks', tasks);
                    }
                }
                updateSyncStatus('tasks', tasks.length);
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π –∏–∑ –±–æ—Ç–∞:', error);
                return false;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –∏–∑ –±–æ—Ç–∞
        async function loadExamsFromBot() {
            try {
                const botExams = await loadDataFromBot('exams');
                if (botExams && Array.isArray(botExams) && botExams.length > 0) {
                    exams = botExams;
                    saveExamsToLocalStorage();
                    updateSyncStatus('exams', exams.length);
                    return true;
                } else {
                    const savedExams = localStorage.getItem(STORAGE_PREFIX + 'exams');
                    if (savedExams) {
                        exams = JSON.parse(savedExams);
                    } else {
                        exams = getInitialExams();
                        saveExamsToLocalStorage();
                        await saveDataToBot('exams', exams);
                    }
                }
                updateSyncStatus('exams', exams.length);
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –∏–∑ –±–æ—Ç–∞:', error);
                return false;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–æ—Ä–∏–∏ –∏–∑ –±–æ—Ç–∞
        async function loadTheoryFromBot() {
            try {
                const botTheory = await loadDataFromBot('theory');
                if (botTheory && Array.isArray(botTheory) && botTheory.length > 0) {
                    theory = botTheory;
                    saveTheoryToLocalStorage();
                    updateSyncStatus('theory', theory.length);
                    return true;
                } else {
                    const savedTheory = localStorage.getItem(STORAGE_PREFIX + 'theory');
                    if (savedTheory) {
                        theory = JSON.parse(savedTheory);
                    } else {
                        theory = getInitialTheory();
                        saveTheoryToLocalStorage();
                        await saveDataToBot('theory', theory);
                    }
                }
                updateSyncStatus('theory', theory.length);
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–æ—Ä–∏–∏ –∏–∑ –±–æ—Ç–∞:', error);
                return false;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –≤ –±–æ—Ç–µ
        async function saveTasksToBot() {
            try {
                const success = await saveDataToBot('tasks', tasks);
                if (success) {
                    showSyncStatus('–ó–∞–¥–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–æ—Ç–µ', 'success');
                    return true;
                }
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –≤ –±–æ—Ç–µ:', error);
                showSyncStatus('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π', 'error');
                return false;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –≤ –±–æ—Ç–µ
        async function saveExamsToBot() {
            try {
                const success = await saveDataToBot('exams', exams);
                if (success) {
                    showSyncStatus('–ü—Ä–æ–±–Ω–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–æ—Ç–µ', 'success');
                    return true;
                }
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –≤ –±–æ—Ç–µ:', error);
                showSyncStatus('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–Ω–∏–∫–æ–≤', 'error');
                return false;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏ –≤ –±–æ—Ç–µ
        async function saveTheoryToBot() {
            try {
                const success = await saveDataToBot('theory', theory);
                if (success) {
                    showSyncStatus('–¢–µ–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –±–æ—Ç–µ', 'success');
                    return true;
                }
                return false;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏ –≤ –±–æ—Ç–µ:', error);
                showSyncStatus('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏', 'error');
                return false;
            }
        }
        
        // ==================== SYNC FUNCTIONS ====================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        function showSyncStatus(message, type = 'info') {
            const statusElement = document.getElementById('sync-status');
            const textElement = document.getElementById('sync-text');
            
            statusElement.className = 'sync-status ' + type;
            textElement.textContent = message;
            statusElement.style.display = 'flex';
            
            if (type !== 'syncing') {
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 3000);
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –∞–¥–º–∏–Ω–∫–µ
        function updateSyncStatus(type, count) {
            if (type === 'tasks') {
                document.getElementById('sync-tasks-status').textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${count}`;
            } else if (type === 'exams') {
                document.getElementById('sync-exams-status').textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${count}`;
            } else if (type === 'theory') {
                document.getElementById('sync-theory-status').textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${count}`;
            }
        }
        
        // –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
        function startAutoSync() {
            if (!document.getElementById('auto-sync-enabled').checked) return;
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å—Ä–∞–∑—É
            syncAllData();
            
            // –ó–∞—Ç–µ–º –∫–∞–∂–¥—ã–µ SYNC_INTERVAL –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
            setInterval(async () => {
                if (document.getElementById('auto-sync-enabled').checked) {
                    await syncAllData();
                }
            }, SYNC_INTERVAL);
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        async function syncAllData() {
            if (!botToken || botToken === 'YOUR_BOT_TOKEN_HERE') return;
            
            showSyncStatus('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...', 'syncing');
            
            try {
                let changed = false;
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞–Ω–∏–π
                const botTasks = await loadDataFromBot('tasks');
                if (botTasks && JSON.stringify(botTasks) !== JSON.stringify(tasks)) {
                    tasks = botTasks;
                    saveTasksToLocalStorage();
                    renderTasksList();
                    updateStatsDisplay();
                    changed = true;
                }
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–Ω–∏–∫–æ–≤
                const botExams = await loadDataFromBot('exams');
                if (botExams && JSON.stringify(botExams) !== JSON.stringify(exams)) {
                    exams = botExams;
                    saveExamsToLocalStorage();
                    renderExamsList();
                    changed = true;
                }
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–æ—Ä–∏–∏
                const botTheory = await loadDataFromBot('theory');
                if (botTheory && JSON.stringify(botTheory) !== JSON.stringify(theory)) {
                    theory = botTheory;
                    saveTheoryToLocalStorage();
                    renderTheory();
                    changed = true;
                }
                
                lastSyncTime = Date.now();
                document.getElementById('last-sync-time').textContent = new Date().toLocaleString();
                
                if (changed) {
                    showSyncStatus('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
                } else {
                    setTimeout(() => {
                        document.getElementById('sync-status').style.display = 'none';
                    }, 1000);
                }
                
                return changed;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
                showSyncStatus('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏', 'error');
                return false;
            }
        }
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
        async function forceSync() {
            showSyncStatus('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...', 'syncing');
            const result = await syncAllData();
            return result;
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
        async function syncUserDataWithBot() {
            try {
                const userData = {
                    userId: userId,
                    stats: stats,
                    lastActive: new Date().toISOString()
                };
                
                let usersData = await loadDataFromBot('users') || [];
                const userIndex = usersData.findIndex(u => u.userId === userId);
                
                if (userIndex !== -1) {
                    usersData[userIndex] = userData;
                } else {
                    usersData.push(userData);
                }
                
                await saveDataToBot('users', usersData);
                
                if (isAdminAuthenticated) {
                    updateAdminUsersStats(usersData);
                }
                
                return true;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:', error);
                return false;
            }
        }
        
        // ==================== LOCAL STORAGE FUNCTIONS ====================
        
        function loadUserData() {
            const storageKey = STORAGE_PREFIX + userId;
            const savedStats = localStorage.getItem(storageKey + '_stats');
            const savedAchievements = localStorage.getItem(storageKey + '_achievements');
            
            const isNewUser = !savedStats && !savedAchievements;
            
            if (savedStats) {
                const loadedStats = JSON.parse(savedStats);
                const today = new Date().toISOString().split('T')[0];
                if (loadedStats.dailyDate !== today) {
                    loadedStats.dailyProgress = 0;
                    loadedStats.dailyDate = today;
                }
                updateStreakLogic(loadedStats);
                stats = loadedStats;
            }
            
            if (savedAchievements) {
                achievements = JSON.parse(savedAchievements);
            } else {
                achievements = getInitialAchievements();
            }
            
            if (isNewUser && document.getElementById('auto-reset-new-users')?.checked !== false) {
                resetUserData();
            }
            
            saveUserDataToLocalStorage();
        }
        
        function saveUserDataToLocalStorage() {
            const storageKey = STORAGE_PREFIX + userId;
            localStorage.setItem(storageKey + '_stats', JSON.stringify(stats));
            localStorage.setItem(storageKey + '_achievements', JSON.stringify(achievements));
        }
        
        function saveTasksToLocalStorage() {
            localStorage.setItem(STORAGE_PREFIX + 'tasks', JSON.stringify(tasks));
        }
        
        function saveExamsToLocalStorage() {
            localStorage.setItem(STORAGE_PREFIX + 'exams', JSON.stringify(exams));
        }
        
        function saveTheoryToLocalStorage() {
            localStorage.setItem(STORAGE_PREFIX + 'theory', JSON.stringify(theory));
        }
        
        // ==================== EXAM FUNCTIONS ====================
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–±–Ω–∏–∫–æ–≤
        function renderExamsList() {
            const container = document.getElementById('exams-grid');
            const countElement = document.getElementById('exams-count');
            
            if (exams.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="empty-title">–ù–µ—Ç –ø—Ä–æ–±–Ω–∏–∫–æ–≤</div>
                        <p>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–±–∞–≤–∏—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                    </div>
                `;
                countElement.textContent = '0 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤';
                return;
            }
            
            let html = '';
            exams.forEach(exam => {
                const isSolved = stats.solvedExams.includes(exam.id);
                const score = stats.examScores[exam.id] || 0;
                const progressPercent = isSolved ? 100 : 0;
                
                html += `
                    <div class="exam-variant" data-exam-id="${exam.id}">
                        <div class="exam-variant-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="exam-variant-title">${exam.title}</div>
                        <div class="exam-variant-desc">${exam.description}</div>
                        <div class="exam-variant-progress">
                            <div class="exam-variant-progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <div class="exam-variant-stats">
                            <span>${exam.tasksCount} –∑–∞–¥–∞–Ω–∏–π</span>
                            <span>${exam.time} –º–∏–Ω</span>
                            ${isSolved ? `<span>${score}%</span>` : '<span>–ù–µ –Ω–∞—á–∞—Ç</span>'}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            countElement.textContent = `${exams.length} –≤–∞—Ä–∏–∞–Ω—Ç${exams.length % 10 === 1 ? '' : '–∞'}`;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            document.querySelectorAll('.exam-variant').forEach(item => {
                item.addEventListener('click', function() {
                    const examId = parseInt(this.getAttribute('data-exam-id'));
                    startExam(examId);
                });
            });
        }
        
        // –ù–∞—á–∞—Ç—å –ø—Ä–æ–±–Ω–∏–∫
        function startExam(examId) {
            currentExam = exams.find(e => e.id === examId);
            if (!currentExam) return;
            
            // –°–æ–±–∏—Ä–∞–µ–º –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–±–Ω–∏–∫–∞
            currentExamTasks = [];
            if (currentExam.taskIds && currentExam.taskIds.length > 0) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ ID –∑–∞–¥–∞–Ω–∏–π
                currentExam.taskIds.forEach(taskId => {
                    const task = tasks.find(t => t.id === taskId);
                    if (task) currentExamTasks.push(task);
                });
            } else {
                // –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–¥–±–æ—Ä –∑–∞–¥–∞–Ω–∏–π
                const availableTasks = [...tasks];
                for (let i = 0; i < Math.min(currentExam.tasksCount, availableTasks.length); i++) {
                    const randomIndex = Math.floor(Math.random() * availableTasks.length);
                    currentExamTasks.push(availableTasks[randomIndex]);
                    availableTasks.splice(randomIndex, 1);
                }
            }
            
            if (currentExamTasks.length === 0) {
                showNotification('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–±–Ω–∏–∫–∞', 'error');
                return;
            }
            
            currentExamIndex = 0;
            examTimeLeft = currentExam.time * 60; // –í —Å–µ–∫—É–Ω–¥–∞—Ö
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø—Ä–æ–±–Ω–∏–∫–∞
            switchTab('practice');
            showExamTask();
            startExamTimer();
            
            showNotification(`–ù–∞—á–∞—Ç –ø—Ä–æ–±–Ω–∏–∫: ${currentExam.title}`, 'info');
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ –∏–∑ –ø—Ä–æ–±–Ω–∏–∫–∞
        function showExamTask() {
            if (currentExamIndex >= currentExamTasks.length) {
                finishExam();
                return;
            }
            
            currentTask = currentExamTasks[currentExamIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.getElementById('task-number').textContent = `–ü—Ä–æ–±–Ω–∏–∫: ${currentExam.title} (${currentExamIndex + 1}/${currentExamTasks.length})`;
            document.getElementById('task-theme').textContent = `–ó–∞–¥–∞–Ω–∏–µ ${currentExamIndex + 1}`;
            document.getElementById('task-text').innerHTML = currentTask.text;
            document.getElementById('answer-input').value = '';
            
            // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            document.getElementById('result-container').innerHTML = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
            updateFavoriteButton();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            renderTaskOptions();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
            updateExamTimerDisplay();
        }
        
        // –¢–∞–π–º–µ—Ä –ø—Ä–æ–±–Ω–∏–∫–∞
        function startExamTimer() {
            if (examTimer) clearInterval(examTimer);
            
            examTimer = setInterval(() => {
                examTimeLeft--;
                updateExamTimerDisplay();
                
                if (examTimeLeft <= 0) {
                    clearInterval(examTimer);
                    finishExam();
                    showNotification('–í—Ä–µ–º—è –≤—ã—à–ª–æ!', 'error');
                }
            }, 1000);
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
        function updateExamTimerDisplay() {
            const minutes = Math.floor(examTimeLeft / 60);
            const seconds = examTimeLeft % 60;
            document.getElementById('task-theme').textContent = 
                `–ó–∞–¥–∞–Ω–∏–µ ${currentExamIndex + 1}/${currentExamTasks.length} | ${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–±–Ω–∏–∫
        function finishExam() {
            if (examTimer) {
                clearInterval(examTimer);
                examTimer = null;
            }
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const correctAnswers = stats.correctAttempts; // –≠—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞
            
            if (currentExam && !stats.solvedExams.includes(currentExam.id)) {
                stats.solvedExams.push(currentExam.id);
                const score = Math.round((correctAnswers / currentExamTasks.length) * 100);
                stats.examScores[currentExam.id] = score;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                updateAchievement('exam_master', stats.solvedExams.length);
                
                showNotification(`–ü—Ä–æ–±–Ω–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω! –†–µ–∑—É–ª—å—Ç–∞—Ç: ${score}%`, 'success');
            }
            
            saveUserDataToLocalStorage();
            syncUserDataWithBot();
            renderExamsList();
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –æ–±—ã—á–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ
            currentExam = null;
            currentExamTasks = [];
            currentExamIndex = 0;
            showRandomTask();
        }
        
        // ==================== ADMIN EXAM FUNCTIONS ====================
        
        // –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function populateEditExamSelect() {
            const select = document.getElementById('admin-edit-exam-select');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç...</option>';
            
            exams.forEach(exam => {
                const option = document.createElement('option');
                option.value = exam.id;
                option.textContent = `${exam.title} (${exam.tasksCount} –∑–∞–¥–∞–Ω–∏–π, ${exam.time} –º–∏–Ω)`;
                select.appendChild(option);
            });
        }
        
        // –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–Ω–∏–∫–∞
        function enableExamEditMode(examId) {
            editingExamId = examId;
            const exam = exams.find(e => e.id === examId);
            
            if (!exam) return;
            
            document.getElementById('admin-exam-title').value = exam.title;
            document.getElementById('admin-exam-description').value = exam.description;
            document.getElementById('admin-exam-tasks-count').value = exam.tasksCount;
            document.getElementById('admin-exam-task-ids').value = exam.taskIds ? exam.taskIds.join(', ') : '';
            document.getElementById('admin-exam-time').value = exam.time;
            document.getElementById('admin-exam-difficulty').value = exam.difficulty || '—Å—Ä–µ–¥–Ω–∏–π';
            
            document.getElementById('save-exam-btn-text').textContent = '–û–±–Ω–æ–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç';
            document.getElementById('delete-exam-btn').style.display = 'block';
        }
        
        // –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–Ω–∏–∫–∞
        function disableExamEditMode() {
            editingExamId = null;
            document.getElementById('admin-exam-title').value = '';
            document.getElementById('admin-exam-description').value = '';
            document.getElementById('admin-exam-tasks-count').value = 10;
            document.getElementById('admin-exam-task-ids').value = '';
            document.getElementById('admin-exam-time').value = 60;
            document.getElementById('admin-exam-difficulty').value = '—Å—Ä–µ–¥–Ω–∏–π';
            document.getElementById('save-exam-btn-text').textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç';
            document.getElementById('delete-exam-btn').style.display = 'none';
            document.getElementById('admin-exam-edit-mode').value = 'new';
            document.getElementById('edit-exam-select-group').style.display = 'none';
            document.getElementById('admin-edit-exam-select').value = '';
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–±–Ω–∏–∫
        async function saveExam() {
            const title = document.getElementById('admin-exam-title').value.trim();
            const description = document.getElementById('admin-exam-description').value.trim();
            const tasksCount = parseInt(document.getElementById('admin-exam-tasks-count').value);
            const taskIdsInput = document.getElementById('admin-exam-task-ids').value.trim();
            const time = parseInt(document.getElementById('admin-exam-time').value);
            const difficulty = document.getElementById('admin-exam-difficulty').value;
            
            if (!title) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞', 'error');
                return;
            }
            
            if (tasksCount < 1 || tasksCount > 27) {
                showNotification('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 1 –¥–æ 27', 'error');
                return;
            }
            
            if (time < 5 || time > 240) {
                showNotification('–í—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 5 –¥–æ 240 –º–∏–Ω—É—Ç', 'error');
                return;
            }
            
            // –ü–∞—Ä—Å–∏–º ID –∑–∞–¥–∞–Ω–∏–π
            let taskIds = [];
            if (taskIdsInput) {
                taskIds = taskIdsInput.split(',').map(id => parseInt(id.trim())).filter(id => !isNaN(id));
            }
            
            if (editingExamId) {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–±–Ω–∏–∫–∞
                const examIndex = exams.findIndex(e => e.id === editingExamId);
                if (examIndex !== -1) {
                    exams[examIndex] = {
                        ...exams[examIndex],
                        title: title,
                        description: description,
                        tasksCount: tasksCount,
                        taskIds: taskIds.length > 0 ? taskIds : undefined,
                        time: time,
                        difficulty: difficulty,
                        updatedAt: Date.now()
                    };
                    showNotification('–í–∞—Ä–∏–∞–Ω—Ç —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
                }
            } else {
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–±–Ω–∏–∫–∞
                const newExam = {
                    id: Date.now(),
                    title: title,
                    description: description,
                    tasksCount: tasksCount,
                    taskIds: taskIds.length > 0 ? taskIds : undefined,
                    time: time,
                    difficulty: difficulty,
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                };
                
                exams.push(newExam);
                showNotification('–í–∞—Ä–∏–∞–Ω—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            saveExamsToLocalStorage();
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –±–æ—Ç–æ–º
            const syncSuccess = await saveExamsToBot();
            
            if (syncSuccess) {
                renderExamsList();
                updateNewExamsBadge();
                renderAdminExamsList();
                populateEditExamSelect();
                disableExamEditMode();
            }
        }
        
        // –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–±–Ω–∏–∫
        async function deleteExam() {
            if (!editingExamId) return;
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç? –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ—Ç–µ—Ä—è—é—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É.')) {
                const examIndex = exams.findIndex(e => e.id === editingExamId);
                if (examIndex !== -1) {
                    exams.splice(examIndex, 1);
                    saveExamsToLocalStorage();
                    
                    const deleteSuccess = await deleteDataFromBot('exams', editingExamId);
                    
                    if (deleteSuccess) {
                        showNotification('–í–∞—Ä–∏–∞–Ω—Ç —É–¥–∞–ª–µ–Ω —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'success');
                    } else {
                        await saveExamsToBot();
                        showNotification('–í–∞—Ä–∏–∞–Ω—Ç —É–¥–∞–ª–µ–Ω', 'success');
                    }
                    
                    renderExamsList();
                    updateNewExamsBadge();
                    renderAdminExamsList();
                    disableExamEditMode();
                }
            }
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–±–Ω–∏–∫–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ
        function renderAdminExamsList() {
            const container = document.getElementById('admin-exams-list');
            
            if (exams.length === 0) {
                container.innerHTML = '<div style="color: var(--text-muted); text-align: center; padding: 20px;">–ù–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>';
                return;
            }
            
            let html = '<div style="display: flex; flex-direction: column; gap: 8px;">';
            
            exams.slice().reverse().forEach(exam => {
                html += `
                    <div class="admin-task-item">
                        <div class="admin-task-info">
                            <div class="admin-task-number" style="color: var(--exam-color);">
                                ${exam.title}
                            </div>
                            <div class="admin-task-text">
                                ${exam.description.substring(0, 50)}${exam.description.length > 50 ? '...' : ''}
                            </div>
                            <div style="font-size: 11px; color: var(--text-muted);">
                                ${exam.tasksCount} –∑–∞–¥–∞–Ω–∏–π ‚Ä¢ ${exam.time} –º–∏–Ω ‚Ä¢ ${exam.difficulty}
                            </div>
                        </div>
                        <div class="admin-task-actions">
                            <button class="admin-task-action-btn edit" data-exam-id="${exam.id}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="admin-task-action-btn delete" data-exam-id="${exam.id}" title="–£–¥–∞–ª–∏—Ç—å">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
            container.querySelectorAll('.admin-task-action-btn.edit[data-exam-id]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const examId = parseInt(this.getAttribute('data-exam-id'));
                    enableExamEditMode(examId);
                    document.getElementById('admin-exam-edit-mode').value = 'edit';
                    document.getElementById('edit-exam-select-group').style.display = 'block';
                    document.getElementById('admin-edit-exam-select').value = examId;
                });
            });
            
            container.querySelectorAll('.admin-task-action-btn.delete[data-exam-id]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const examId = parseInt(this.getAttribute('data-exam-id'));
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç?')) {
                        const examIndex = exams.findIndex(e => e.id === examId);
                        if (examIndex !== -1) {
                            exams.splice(examIndex, 1);
                            saveExamsToLocalStorage();
                            saveExamsToBot();
                            showNotification('–í–∞—Ä–∏–∞–Ω—Ç —É–¥–∞–ª–µ–Ω', 'success');
                            renderAdminExamsList();
                            renderExamsList();
                            
                            if (editingExamId === examId) {
                                disableExamEditMode();
                            }
                        }
                    }
                });
            });
        }
        
        // ==================== INITIAL DATA ====================
        
        function getInitialTasks() {
            return [
                {
                    id: 1,
                    number: 1,
                    theme: "–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è",
                    text: "–í –∫–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –æ—Ç–≤–µ—Ç–∞ <span class='highlight'>–≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ</span> —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ?",
                    options: ["–∫—Ä–ê–Ω—ã", "–¥–û–Ω–∏–∑—É", "–æ—Ç–æ–∑–≤–ê–ª–∞", "–ø–æ–∑–≤–æ–Ω–ò—Ç"],
                    answer: "–∫—Ä–ê–Ω—ã",
                    hint: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–¥–∞—Ä–µ–Ω–∏–µ: –∫—Ä–∞—Å–Ω–´ (–µ–¥.—á. - –∫—Ä–∞–Ω), –¥–æ–Ω–ò–∑—É, –æ—Ç–æ–∑–≤–∞–ª–ê, –ø–æ–∑–≤–æ–Ω–ò—Ç",
                    type: "single",
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                },
                {
                    id: 2,
                    number: 2,
                    theme: "–ü–∞—Ä–æ–Ω–∏–º—ã",
                    text: "–í –∫–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –æ—Ç–≤–µ—Ç–∞ <span class='highlight'>–≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ</span> —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ?",
                    options: [
                        "–≠—Ç–æ –±—ã–ª –ö–û–ú–ê–ù–î–ò–†–û–í–û–ß–ù–´–ô –∞–≤—Ç–æ–º–æ–±–∏–ª—å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è —Å–ª—É–∂–µ–±–Ω—ã—Ö –ø–æ–µ–∑–¥–æ–∫.",
                        "–ù–∞ —Å–æ–±—Ä–∞–Ω–∏–∏ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å –í–û–ü–†–û–°–´ –ñ–ò–õ–ò–©–ù–û–ì–û —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞.",
                        "–ù–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–∏ –¥–µ–π—Å—Ç–≤—É–µ—Ç –≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –æ—Ç–¥–µ–ª, –∑–∞–Ω–∏–º–∞—é—â–∏–π—Å—è –≤–æ–ø—Ä–æ—Å–∞–º–∏ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.",
                        "–û–Ω –±—ã–ª –∏–∑–≤–µ—Å—Ç–Ω—ã–º –î–ò–ü–õ–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ú —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–º, —É–º–µ–≤—à–∏–º –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ–¥—Ö–æ–¥ –∫ –ª—é–±–æ–º—É —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É."
                    ],
                    answer: "–ö–û–ú–ê–ù–î–ò–†–û–í–û–ß–ù–´–ô",
                    hint: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ: –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ, –Ω–æ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å - –Ω–µ–≤–µ—Ä–Ω–æ. –ù—É–∂–Ω–æ: —Å–ª—É–∂–µ–±–Ω—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å.",
                    type: "single",
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                }
            ];
        }
        
        function getInitialExams() {
            return [
                {
                    id: 1,
                    title: "–ü—Ä–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç #1",
                    description: "–ë–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –ï–ì–≠",
                    tasksCount: 10,
                    time: 60,
                    difficulty: "—Å—Ä–µ–¥–Ω–∏–π",
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                },
                {
                    id: 2,
                    title: "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç",
                    description: "–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏",
                    tasksCount: 15,
                    time: 90,
                    difficulty: "–ª–µ–≥–∫–∏–π",
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                }
            ];
        }
        
        function getInitialTheory() {
            return [
                {
                    id: 1,
                    title: "–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –ø—Ä–∞–≤–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏—Å—Ç–∞–≤–æ–∫",
                    content: `
                        <h3>–ü—Ä–∞–≤–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏—Å—Ç–∞–≤–æ–∫ –ü–†–ï- –∏ –ü–†–ò-</h3>
                        <p>–ü—Ä–∏—Å—Ç–∞–≤–∫–∞ –ü–†–ò- –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç:</p>
                        <ul>
                            <li>–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ (–ø—Ä–∏–µ—Ö–∞—Ç—å, –ø—Ä–∏–π—Ç–∏)</li>
                            <li>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–ø—Ä–∏—à–∏—Ç—å, –ø—Ä–∏–∫–ª–µ–∏—Ç—å)</li>
                            <li>–ù–µ–ø–æ–ª–Ω–æ—Ç—É –¥–µ–π—Å—Ç–≤–∏—è (–ø—Ä–∏–æ—Ç–∫—Ä—ã—Ç—å, –ø—Ä–∏—Å–µ—Å—Ç—å)</li>
                            <li>–ë–ª–∏–∑–æ—Å—Ç—å (–ø—Ä–∏–º–æ—Ä—Å–∫–∏–π, –ø—Ä–∏—à–∫–æ–ª—å–Ω—ã–π)</li>
                        </ul>
                        <p>–ü—Ä–∏—Å—Ç–∞–≤–∫–∞ –ü–†–ï- –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç:</p>
                        <ul>
                            <li>–í—ã—Å–æ–∫—É—é —Å—Ç–µ–ø–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞ (–ø—Ä–µ–º—É–¥—Ä—ã–π, –ø—Ä–µ–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π)</li>
                            <li>–ó–Ω–∞—á–µ–Ω–∏–µ "–ø–µ—Ä–µ-" (–ø—Ä–µ–≥—Ä–∞–¥–∏—Ç—å, –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å)</li>
                        </ul>
                    `,
                    createdAt: Date.now()
                }
            ];
        }
        
        function getInitialAchievements() {
            return {
                first_blood: { unlocked: false, progress: 0, max: 1, title: "–ü–µ—Ä–≤–∞—è –∫—Ä–æ–≤—å", desc: "–†–µ—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ" },
                master: { unlocked: false, progress: 0, max: 10, title: "–ú–∞—Å—Ç–µ—Ä —Å–ª–æ–≤–∞", desc: "–†–µ—à–∏—Ç–µ 10 –∑–∞–¥–∞–Ω–∏–π" },
                perfectionist: { unlocked: false, progress: 0, max: 50, title: "–ü–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç", desc: "–†–µ—à–∏—Ç–µ 50 –∑–∞–¥–∞–Ω–∏–π" },
                accurate: { unlocked: false, progress: 0, max: 80, title: "–°–Ω–∞–π–ø–µ—Ä", desc: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 80% —Ç–æ—á–Ω–æ—Å—Ç–∏" },
                daily_streak: { unlocked: false, progress: 0, max: 7, title: "–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞", desc: "–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥" },
                favorite: { unlocked: false, progress: 0, max: 5, title: "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", desc: "–î–æ–±–∞–≤—å—Ç–µ 5 –∑–∞–¥–∞–Ω–∏–π –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ" },
                theorist: { unlocked: false, progress: 0, max: 8, title: "–¢–µ–æ—Ä–µ—Ç–∏–∫", desc: "–ò–∑—É—á–∏—Ç–µ –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã —Ç–µ–æ—Ä–∏–∏" },
                speedrunner: { unlocked: false, progress: 0, max: 5, title: "–°–ø–∏–¥—Ä–∞–Ω–Ω–µ—Ä", desc: "–†–µ—à–∏—Ç–µ 5 –∑–∞–¥–∞–Ω–∏–π –ø–æ–¥—Ä—è–¥ –±–µ–∑ –æ—à–∏–±–æ–∫" },
                grammar_guru: { unlocked: false, progress: 0, max: 15, title: "–ì—É—Ä—É –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏", desc: "–†–µ—à–∏—Ç–µ 15 –∑–∞–¥–∞–Ω–∏–π –ø–æ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏" },
                punctuation_pro: { unlocked: false, progress: 0, max: 10, title: "–ü—Ä–æ—Ñ–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏", desc: "–†–µ—à–∏—Ç–µ 10 –∑–∞–¥–∞–Ω–∏–π –ø–æ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏" },
                exam_ready: { unlocked: false, progress: 0, max: 27, title: "–ì–æ—Ç–æ–≤ –∫ –ï–ì–≠", desc: "–†–µ—à–∏—Ç–µ –ø–æ –æ–¥–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞" },
                exam_master: { unlocked: false, progress: 0, max: 3, title: "–ú–∞—Å—Ç–µ—Ä –ø—Ä–æ–±–Ω–∏–∫–æ–≤", desc: "–ü—Ä–æ–π–¥–∏—Ç–µ 3 –ø—Ä–æ–±–Ω–∏–∫–∞" },
                all_star: { unlocked: false, progress: 0, max: 100, title: "–í—Å–µ –∑–≤—ë–∑–¥—ã", desc: "–†–µ—à–∏—Ç–µ 100 –∑–∞–¥–∞–Ω–∏–π" }
            };
        }
        
        // ==================== OTHER FUNCTIONS ====================
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (initTelegram, showRandomTask, checkAnswer, –∏ —Ç.–¥.)
        // –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∫–æ–¥–µ, –Ω–æ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–±–Ω–∏–∫–æ–≤
          function updateStreakLogic(statsData) {
            const lastActive = new Date(statsData.lastActive);
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const lastActiveDate = new Date(lastActive.getFullYear(), lastActive.getMonth(), lastActive.getDate());
            
            const diffDays = Math.floor((today - lastActiveDate) / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                // –£–∂–µ –∞–∫—Ç–∏–≤–µ–Ω —Å–µ–≥–æ–¥–Ω—è
                return;
            } else if (diffDays === 1) {
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º streak
                statsData.streak++;
            } else if (diffDays > 1) {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º streak
                statsData.streak = 0;
            }
            
            statsData.lastActive = now.toISOString();
            statsData.lastStreakDate = now.toISOString();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
        function showRandomTask() {
            if (tasks.length === 0) {
                document.getElementById('task-text').textContent = "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π.";
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * tasks.length);
            currentTask = tasks[randomIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.getElementById('task-number').textContent = `–ó–∞–¥–∞–Ω–∏–µ #${currentTask.number}`;
            document.getElementById('task-theme').textContent = currentTask.theme;
            document.getElementById('task-text').innerHTML = currentTask.text;
            document.getElementById('answer-input').value = '';
            
            // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            document.getElementById('result-container').innerHTML = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
            updateFavoriteButton();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –∏–ª–∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            renderTaskOptions();
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
        function renderTaskOptions() {
            const container = document.getElementById('options-container');
            const answerInput = document.getElementById('answer-input');
            
            container.innerHTML = '';
            selectedOptions = {};
            
            if (currentTask.options && currentTask.type === 'single') {
                answerInput.style.display = 'none';
                
                currentTask.options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.innerHTML = `
                        <div class="option-marker">${String.fromCharCode(65 + index)}</div>
                        <div class="option-text">${option}</div>
                    `;
                    
                    optionElement.addEventListener('click', () => {
                        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
                        document.querySelectorAll('.option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
                        optionElement.classList.add('selected');
                        selectedOptions[currentTask.id] = option;
                    });
                    
                    container.appendChild(optionElement);
                });
            } else if (currentTask.type === 'numbers') {
                answerInput.style.display = 'block';
                answerInput.placeholder = "–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1,2,3)";
            } else {
                answerInput.style.display = 'block';
                answerInput.placeholder = "–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç...";
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
        function checkAnswer() {
            let userAnswer;
            
            if (currentTask.type === 'single') {
                userAnswer = selectedOptions[currentTask.id];
                if (!userAnswer) {
                    showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞', 'error');
                    return;
                }
            } else {
                userAnswer = document.getElementById('answer-input').value.trim();
                if (!userAnswer) {
                    showNotification('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç', 'error');
                    return;
                }
            }
            
            // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –æ—Ç–≤–µ—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            const normalizedUserAnswer = userAnswer.toString().toLowerCase().replace(/\s+/g, '');
            const normalizedCorrectAnswer = currentTask.answer.toString().toLowerCase().replace(/\s+/g, '');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            stats.totalAttempts++;
            
            let isCorrect = false;
            
            if (currentTask.type === 'numbers') {
                const userNumbers = normalizedUserAnswer.split(',').map(n => n.trim()).filter(n => n).sort();
                const correctNumbers = normalizedCorrectAnswer.split('').sort();
                isCorrect = JSON.stringify(userNumbers) === JSON.stringify(correctNumbers);
            } else {
                isCorrect = normalizedUserAnswer === normalizedCorrectAnswer;
            }
            
            if (isCorrect) {
                stats.correctAttempts++;
                stats.dailyProgress++;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º streak
                updateStreakLogic(stats);
                
                if (!stats.solvedTasks.includes(currentTask.id)) {
                    stats.solvedTasks.push(currentTask.id);
                    updateAchievement('first_blood', 1);
                    updateAchievement('master', stats.solvedTasks.length);
                    updateAchievement('perfectionist', stats.solvedTasks.length);
                    updateAchievement('all_star', stats.solvedTasks.length);
                    
                    const uniqueTaskNumbers = [...new Set(stats.solvedTasks.map(id => {
                        const task = tasks.find(t => t.id === id);
                        return task ? task.number : null;
                    }))].filter(n => n).length;
                    updateAchievement('exam_ready', uniqueTaskNumbers);
                    
                    const grammarTasks = stats.solvedTasks.filter(id => {
                        const task = tasks.find(t => t.id === id);
                        return task && (task.theme.includes('–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è') || task.theme.includes('–ü—É–Ω–∫—Ç—É–∞—Ü–∏—è'));
                    }).length;
                    updateAchievement('grammar_guru', grammarTasks);
                    updateAchievement('punctuation_pro', grammarTasks);
                }
                
                showResult(true, userAnswer, currentTask.answer);
                showNotification('–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!', 'success');
                
                if (stats.correctAttempts >= 5 && stats.correctAttempts % 5 === 0) {
                    updateAchievement('speedrunner', Math.floor(stats.correctAttempts / 5));
                }
            } else {
                showResult(false, userAnswer, currentTask.answer);
                showNotification('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ò–∑—É—á–∏—Ç–µ —Ç–µ–æ—Ä–∏—é –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.', 'error');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–°–Ω–∞–π–ø–µ—Ä"
            const accuracy = stats.totalAttempts > 0 
                ? Math.round((stats.correctAttempts / stats.totalAttempts) * 100)
                : 0;
            updateAchievement('accurate', accuracy);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateDailyProgress();
            updateStreak();
            saveUserData();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult(isCorrect, userAnswer, correctAnswer) {
            const resultContainer = document.getElementById('result-container');
            
            if (isCorrect) {
                resultContainer.innerHTML = `
                    <div class="result correct">
                        <div class="result-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="result-title">–ü—Ä–∞–≤–∏–ª—å–Ω–æ!</div>
                        <div class="result-desc">–í—ã –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –∑–∞–¥–∞–Ω–∏–µ–º</div>
                        <div class="result-answer">–í–∞—à –æ—Ç–≤–µ—Ç: ${userAnswer}</div>
                    </div>
                `;
            } else {
                resultContainer.innerHTML = `
                    <div class="result incorrect">
                        <div class="result-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="result-title">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                        <div class="result-desc">–ò–∑—É—á–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞</div>
                        <div class="result-answer">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}</div>
                    </div>
                `;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        function updateStatsDisplay() {
            // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('total-tasks').textContent = tasks.length;
            document.getElementById('solved-count').textContent = stats.solvedTasks.length;
            
            const accuracy = stats.totalAttempts > 0 
                ? Math.round((stats.correctAttempts / stats.totalAttempts) * 100)
                : 0;
            document.getElementById('correct-rate').textContent = `${accuracy}%`;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –∑–∞–¥–∞–Ω–∏–π
            document.getElementById('completed-tasks').textContent = stats.solvedTasks.length;
            document.getElementById('favorite-tasks').textContent = stats.favoriteTasks.length;
            document.getElementById('tasks-count').textContent = `${tasks.length} –∑–∞–¥–∞–Ω–∏–π`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∑–∞–¥–∞–Ω–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ
            if (isAdminAuthenticated) {
                document.getElementById('admin-tasks-count').textContent = tasks.length;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function updateDailyProgress() {
            const progressPercent = Math.min((stats.dailyProgress / 5) * 100, 100);
            document.getElementById('daily-progress').style.width = `${progressPercent}%`;
            document.getElementById('daily-solved').textContent = stats.dailyProgress;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ streak
        function updateStreak() {
            document.getElementById('streak-days').textContent = stats.streak;
            
            if (stats.dailyProgress >= 5) {
                document.getElementById('streak-next').textContent = "–í—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!";
            } else {
                document.getElementById('streak-next').textContent = `–û—Å—Ç–∞–ª–æ—Å—å ${5 - stats.dailyProgress} –∑–∞–¥–∞–Ω–∏–π`;
            }
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π
        function renderTasksList() {
            const container = document.getElementById('tasks-list-container');
            
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="empty-title">–ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π</div>
                        <p>–ù–∞—á–Ω–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É!</p>
                    </div>
                `;
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–¥–∞–Ω–∏—è –ø–æ —Ç–µ–º–∞–º
            const tasksByTheme = {};
            tasks.forEach(task => {
                if (!tasksByTheme[task.theme]) {
                    tasksByTheme[task.theme] = [];
                }
                tasksByTheme[task.theme].push(task);
            });
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∑–∞–¥–∞–Ω–∏—è –ø–æ —Ç–µ–º–∞–º
            let html = '';
            for (const theme in tasksByTheme) {
                html += `
                    <div class="task-card" style="margin-top: 12px;">
                        <div class="task-header">
                            <div>
                                <div class="task-number">${theme}</div>
                                <div class="task-theme">${tasksByTheme[theme].length} –∑–∞–¥–∞–Ω–∏–π</div>
                            </div>
                        </div>
                        <div class="options-container">
                `;
                
                tasksByTheme[theme].forEach(task => {
                    const isSolved = stats.solvedTasks.includes(task.id);
                    const isFavorite = stats.favoriteTasks.includes(task.id);
                    
                    html += `
                        <div class="option ${isSolved ? 'selected' : ''}" data-task-id="${task.id}">
                            <div class="option-marker">${task.number}</div>
                            <div class="option-text">
                                ${task.text.substring(0, 60)}${task.text.length > 60 ? '...' : ''}
                                ${isFavorite ? '<i class="fas fa-star" style="color: var(--warning-color); margin-left: 6px;"></i>' : ''}
                            </div>
                            ${isSolved ? '<i class="fas fa-check" style="color: var(--success-color);"></i>' : ''}
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–∞
            document.querySelectorAll('.option[data-task-id]').forEach(item => {
                item.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-task-id'));
                    const task = tasks.find(t => t.id === taskId);
                    
                    if (task) {
                        switchTab('practice');
                        currentTask = task;
                        document.getElementById('task-number').textContent = `–ó–∞–¥–∞–Ω–∏–µ #${currentTask.number}`;
                        document.getElementById('task-theme').textContent = currentTask.theme;
                        document.getElementById('task-text').innerHTML = currentTask.text;
                        document.getElementById('answer-input').value = '';
                        updateFavoriteButton();
                        renderTaskOptions();
                        document.getElementById('result-container').innerHTML = '';
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
            });
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–µ–æ—Ä–∏–∏
        function renderTheory() {
            const container = document.getElementById('theory-content-container');
            
            if (theory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="empty-title">–¢–µ–æ—Ä–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è</div>
                        <p>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–±–∞–≤–∏—Ç –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            theory.forEach((section, index) => {
                html += `
                    <div class="theory-section">
                        <div class="theory-header">
                            <div class="theory-icon">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="theory-title">${section.title}</div>
                        </div>
                        <div class="theory-content">
                            ${section.content}
                        </div>
                        <div style="text-align: center; margin-top: 16px;">
                            <button class="btn btn-secondary practice-theory-btn" data-theme="${section.title.split(':')[0]}">
                                <i class="fas fa-play-circle"></i>
                                <span>–ü–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            document.querySelectorAll('.practice-theory-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    switchTab('practice');
                    
                    // –ù–∞—Ö–æ–¥–∏–º –∑–∞–¥–∞–Ω–∏–µ –ø–æ —Ç–µ–º–µ
                    const themeTasks = tasks.filter(t => t.theme.includes(theme));
                    if (themeTasks.length > 0) {
                        const randomTask = themeTasks[Math.floor(Math.random() * themeTasks.length)];
                        currentTask = randomTask;
                        document.getElementById('task-number').textContent = `–ó–∞–¥–∞–Ω–∏–µ #${currentTask.number}`;
                        document.getElementById('task-theme').textContent = currentTask.theme;
                        document.getElementById('task-text').innerHTML = currentTask.text;
                        document.getElementById('answer-input').value = '';
                        updateFavoriteButton();
                        renderTaskOptions();
                        document.getElementById('result-container').innerHTML = '';
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
            });
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function renderAchievements() {
            const container = document.getElementById('achievements-grid');
            let unlockedCount = 0;
            let totalCount = 0;
            
            let html = '';
            
            for (const key in achievements) {
                const achievement = achievements[key];
                totalCount++;
                
                if (achievement.unlocked) {
                    unlockedCount++;
                }
                
                const progressPercent = (achievement.progress / achievement.max) * 100;
                
                html += `
                    <div class="achievement ${achievement.unlocked ? 'unlocked' : 'locked'}">
                        <div class="achievement-badge">
                            <i class="fas fa-${achievement.unlocked ? 'trophy' : 'lock'}"></i>
                        </div>
                        <div class="achievement-title">${achievement.title}</div>
                        <div class="achievement-desc">${achievement.desc}</div>
                        ${!achievement.unlocked ? `
                            <div class="achievement-progress">
                                <div class="achievement-progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">
                                ${achievement.progress}/${achievement.max}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
            container.innerHTML = html;
            document.getElementById('achievements-count').textContent = `${unlockedCount}/${totalCount}`;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function updateAchievement(key, progress, increment = false) {
            if (!achievements[key]) return;
            
            if (increment) {
                achievements[key].progress += progress;
            } else {
                achievements[key].progress = progress;
            }
            
            if (achievements[key].progress >= achievements[key].max) {
                achievements[key].progress = achievements[key].max;
                achievements[key].unlocked = true;
                
                if (!increment || progress > 0) {
                    showNotification(`–ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievements[key].title}`, 'success');
                }
            }
            
            saveUserData();
        }
        
        // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function resetUserData() {
            stats = {
                totalAttempts: 0,
                correctAttempts: 0,
                solvedTasks: [],
                favoriteTasks: [],
                lastActive: new Date().toISOString(),
                streak: 0,
                lastStreakDate: new Date().toISOString(),
                dailyProgress: 0,
                dailyDate: new Date().toISOString().split('T')[0]
            };
            
            achievements = getInitialAchievements();
            
            saveUserData();
            updateStatsDisplay();
            updateDailyProgress();
            updateStreak();
            renderAchievements();
            
            showNotification('–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã', 'info');
        }
        
        // –ê–¥–º–∏–Ω: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
        function addNewTask() {
            const number = parseInt(document.getElementById('admin-task-number').value);
            const theme = document.getElementById('admin-task-theme').value;
            const text = document.getElementById('admin-task-text').value.trim();
            const type = document.getElementById('admin-task-type').value;
            const options = document.getElementById('admin-task-options').value.split(';').map(opt => opt.trim()).filter(opt => opt);
            const answer = document.getElementById('admin-task-answer').value.trim();
            const hint = document.getElementById('admin-task-hint').value.trim();
            
            if (!text) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è', 'error');
                return;
            }
            
            if (!answer) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç', 'error');
                return;
            }
            
            if (number < 1 || number > 27) {
                showNotification('–ù–æ–º–µ—Ä –∑–∞–¥–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 1 –¥–æ 27', 'error');
                return;
            }
            
            if (type === 'single' && options.length < 2) {
                showNotification('–î–æ–±–∞–≤—å—Ç–µ –º–∏–Ω–∏–º—É–º 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞', 'error');
                return;
            }
            
            const newTask = {
                id: Date.now(),
                number: number,
                theme: theme,
                text: text,
                type: type,
                answer: answer,
                hint: hint || "–ü–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞"
            };
            
            if (type === 'single') {
                newTask.options = options;
            }
            
            tasks.push(newTask);
            saveTasks();
            
            document.getElementById('admin-task-text').value = '';
            document.getElementById('admin-task-options').value = '';
            document.getElementById('admin-task-answer').value = '';
            document.getElementById('admin-task-hint').value = '';
            
            showNotification('–ó–∞–¥–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success');
            renderAdminTasksList();
        }
        
        // –ê–¥–º–∏–Ω: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏
        function addNewTheory() {
            const title = document.getElementById('admin-theory-title').value.trim();
            const content = document.getElementById('admin-theory-content').value.trim();
            
            if (!title) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞', 'error');
                return;
            }
            
            if (!content) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞', 'error');
                return;
            }
            
            const newTheory = {
                id: Date.now(),
                title: title,
                content: content
            };
            
            theory.push(newTheory);
            saveTheory();
            
            document.getElementById('admin-theory-title').value = '';
            document.getElementById('admin-theory-content').value = '';
            
            showNotification('–†–∞–∑–¥–µ–ª —Ç–µ–æ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
            renderAdminTheoryList();
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ
        function renderAdminTasksList() {
            const container = document.getElementById('admin-tasks-list');
            
            if (tasks.length === 0) {
                container.innerHTML = '<div style="color: var(--text-muted); text-align: center; padding: 20px;">–ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π</div>';
                return;
            }
            
            let html = '<div style="display: flex; flex-direction: column; gap: 8px;">';
            
            tasks.slice(-10).reverse().forEach(task => {
                html += `
                    <div style="background: var(--bg-secondary); padding: 10px; border-radius: var(--radius-sm); border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--accent-primary); margin-bottom: 4px;">
                            –ó–∞–¥–∞–Ω–∏–µ #${task.number} ‚Ä¢ ${task.theme}
                        </div>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            ${task.text.substring(0, 50)}${task.text.length > 50 ? '...' : ''}
                        </div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 4px;">
                            –û—Ç–≤–µ—Ç: ${task.answer}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ —Ç–µ–æ—Ä–∏–∏ –≤ –∞–¥–º–∏–Ω–∫–µ
        function renderAdminTheoryList() {
            const container = document.getElementById('admin-theory-list');
            
            if (theory.length === 0) {
                container.innerHTML = '<div style="color: var(--text-muted); text-align: center; padding: 20px;">–ù–µ—Ç —Ä–∞–∑–¥–µ–ª–æ–≤ —Ç–µ–æ—Ä–∏–∏</div>';
                return;
            }
            
            let html = '<div style="display: flex; flex-direction: column; gap: 8px;">';
            
            theory.slice(-10).reverse().forEach(section => {
                html += `
                    <div style="background: var(--bg-secondary); padding: 10px; border-radius: var(--radius-sm); border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--accent-primary); margin-bottom: 4px;">
                            ${section.title}
                        </div>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            ${section.content.substring(0, 80)}${section.content.length > 80 ? '...' : ''}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        function showAdminPanel() {
            if (!isAdminAuthenticated) {
                showAuthModal();
                return;
            }
            
            document.getElementById('admin-panel').classList.add('active');
            tg.BackButton.show();
            renderAdminTasksList();
            renderAdminTheoryList();
            document.getElementById('admin-tasks-count').textContent = tasks.length;
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        function closeAdminPanel() {
            document.getElementById('admin-panel').classList.remove('active');
            tg.BackButton.hide();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showAuthModal() {
            document.getElementById('auth-modal').classList.add('active');
            document.getElementById('admin-password').focus();
            document.getElementById('auth-error').textContent = '';
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function hideAuthModal() {
            document.getElementById('auth-modal').classList.remove('active');
            document.getElementById('admin-password').value = '';
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
        function checkPassword() {
            const password = document.getElementById('admin-password').value;
            
            if (password === ADMIN_PASSWORD) {
                isAdminAuthenticated = true;
                hideAuthModal();
                showAdminPanel();
                showNotification('–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω', 'success');
            } else {
                document.getElementById('auth-error').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
                document.getElementById('admin-password').value = '';
                document.getElementById('admin-password').focus();
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-tab') === tabName) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        function switchAdminTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-admin-tab') === tabName) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`admin-${tabName}-tab`).classList.add('active');
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–π–¥–∂–∞ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        function updateNewTasksBadge() {
            const badge = document.getElementById('new-tasks-badge');
            const newTasksCount = tasks.length - stats.solvedTasks.length;
            
            if (newTasksCount > 0) {
                badge.textContent = newTasksCount > 9 ? '9+' : newTasksCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint() {
            if (!currentTask || !currentTask.hint) {
                showNotification('–î–ª—è —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏', 'info');
                return;
            }
            
            showNotification(currentTask.hint, 'info');
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        function toggleFavorite() {
            if (!currentTask) return;
            
            const index = stats.favoriteTasks.indexOf(currentTask.id);
            
            if (index === -1) {
                stats.favoriteTasks.push(currentTask.id);
                showNotification('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', 'success');
                updateAchievement('favorite', stats.favoriteTasks.length);
            } else {
                stats.favoriteTasks.splice(index, 1);
                showNotification('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
            }
            
            updateFavoriteButton();
            saveUserData();
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        function updateFavoriteButton() {
            const favoriteBtn = document.getElementById('favorite-btn');
            const icon = favoriteBtn.querySelector('i');
            
            if (currentTask && stats.favoriteTasks.includes(currentTask.id)) {
                icon.className = 'fas fa-star';
                favoriteBtn.style.color = 'var(--warning-color)';
            } else {
                icon.className = 'far fa-star';
                favoriteBtn.style.color = '';
            }
        }
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            tg.showAlert(message);
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
            document.getElementById('check-btn').addEventListener('click', checkAnswer);
            document.getElementById('next-btn').addEventListener('click', showRandomTask);
            document.getElementById('hint-btn').addEventListener('click', showHint);
            document.getElementById('favorite-btn').addEventListener('click', toggleFavorite);
            
            // –ö–Ω–æ–ø–∫–∏ –≤ —à–∞–ø–∫–µ
            document.getElementById('stats-btn').addEventListener('click', () => switchTab('tasks'));
            document.getElementById('achievements-btn').addEventListener('click', () => switchTab('achievements'));
            document.getElementById('admin-btn').addEventListener('click', showAdminPanel);
            
            // –í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞ –ø–æ Enter
            document.getElementById('answer-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            
            // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            document.getElementById('close-admin').addEventListener('click', closeAdminPanel);
            document.getElementById('save-task-btn').addEventListener('click', addNewTask);
            document.getElementById('save-theory-btn').addEventListener('click', addNewTheory);
            document.getElementById('clear-theory-btn').addEventListener('click', () => {
                document.getElementById('admin-theory-title').value = '';
                document.getElementById('admin-theory-content').value = '';
            });
            document.getElementById('reset-user-btn').addEventListener('click', resetUserData);
            
            // –í–∫–ª–∞–¥–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-admin-tab');
                    switchAdminTab(tabName);
                });
            });
            
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            document.getElementById('submit-password').addEventListener('click', checkPassword);
            document.getElementById('cancel-auth').addEventListener('click', hideAuthModal);
            document.getElementById('admin-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
            
            // –¢–∏–ø –∑–∞–¥–∞–Ω–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ
            document.getElementById('admin-task-type').addEventListener('change', function() {
                const optionsGroup = document.getElementById('admin-options-group');
                if (this.value === 'single') {
                    optionsGroup.style.display = 'block';
                } else {
                    optionsGroup.style.display = 'none';
                }
            });
        }
        // –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞ –æ–ø—É—Å–∫–∞—é –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ñ—É–Ω–∫—Ü–∏–∏
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
        
        // –ü—Ä–∏–º–µ—Ä: —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–π–¥–∂–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ–±–Ω–∏–∫–æ–≤
        function updateNewExamsBadge() {
            const badge = document.getElementById('new-exams-badge');
            const newExamsCount = exams.length - stats.solvedExams.length;
            
            if (newExamsCount > 0) {
                badge.textContent = newExamsCount > 9 ? '9+' : newExamsCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.getElementById('check-btn').addEventListener('click', checkAnswer);
            document.getElementById('next-btn').addEventListener('click', showRandomTask);
            document.getElementById('hint-btn').addEventListener('click', showHint);
            document.getElementById('favorite-btn').addEventListener('click', toggleFavorite);
            document.getElementById('start-exam-btn').addEventListener('click', () => {
                if (exams.length > 0) {
                    const randomIndex = Math.floor(Math.random() * exams.length);
                    startExam(exams[randomIndex].id);
                } else {
                    showNotification('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ–±–Ω–∏–∫–æ–≤', 'error');
                }
            });
            
            // –ö–Ω–æ–ø–∫–∏ –≤ —à–∞–ø–∫–µ
            document.getElementById('stats-btn').addEventListener('click', () => switchTab('tasks'));
            document.getElementById('achievements-btn').addEventListener('click', () => switchTab('achievements'));
            document.getElementById('sync-btn').addEventListener('click', forceSync);
            document.getElementById('admin-btn').addEventListener('click', showAdminPanel);
            
            // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            document.getElementById('close-admin').addEventListener('click', closeAdminPanel);
            document.getElementById('save-task-btn').addEventListener('click', saveTask);
            document.getElementById('delete-task-btn').addEventListener('click', deleteTask);
            document.getElementById('save-exam-btn').addEventListener('click', saveExam);
            document.getElementById('delete-exam-btn').addEventListener('click', deleteExam);
            document.getElementById('save-theory-btn').addEventListener('click', saveTheory);
            document.getElementById('reset-user-btn').addEventListener('click', resetUserData);
            document.getElementById('force-sync-btn').addEventListener('click', forceSync);
            document.getElementById('clear-cache-btn').addEventListener('click', clearCache);
            document.getElementById('save-bot-settings-btn').addEventListener('click', saveBotSettings);
            
            // –í–∫–ª–∞–¥–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-admin-tab');
                    switchAdminTab(tabName);
                });
            });
            
            // –†–µ–∂–∏–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('admin-edit-mode').addEventListener('change', function() {
                const editGroup = document.getElementById('edit-task-select-group');
                editGroup.style.display = this.value === 'edit' ? 'block' : 'none';
                if (this.value === 'edit') populateEditTaskSelect();
            });
            
            document.getElementById('admin-exam-edit-mode').addEventListener('change', function() {
                const editGroup = document.getElementById('edit-exam-select-group');
                editGroup.style.display = this.value === 'edit' ? 'block' : 'none';
                if (this.value === 'edit') populateEditExamSelect();
            });
            
            // –í—ã–±–æ—Ä –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('admin-edit-task-select').addEventListener('change', function() {
                const taskId = parseInt(this.value);
                if (taskId) enableEditMode(taskId);
            });
            
            document.getElementById('admin-edit-exam-select').addEventListener('change', function() {
                const examId = parseInt(this.value);
                if (examId) enableExamEditMode(examId);
            });
            
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            document.getElementById('submit-password').addEventListener('click', checkPassword);
            document.getElementById('cancel-auth').addEventListener('click', hideAuthModal);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
